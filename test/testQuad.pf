
!                      Full test:

@test
subroutine fullQTest( )

  use paratype
  use typeScale
  use typeQuad
  use typeFMesh
  use pfunit_mod

  implicit none

  real(kind=wp) :: gamma0, rho, aw, ux, uy, lamw
  character(32_ip) :: und

  type(fScale) :: tScale
  type(fQuad) :: tQuad
  type(fFmesh) :: tfmesh


  real(kind=wp) :: sX(5), sY(5), sZ2(5), sPr(5), sPi(5), sGam(5)

  real(kind=wp) :: sA(10)
  
  real(kind=wp) :: sX_ex(5), sY_ex(5), sZ2_ex(5), sPr_ex(5), sPi_ex(5), sGam_ex(5)

  real(kind=wp) :: sA_ex(10)
  real(kind=wp) :: sZ, sZ_ex

  real(kind=wp) :: tol

  rho = 0.001_wp
  aw = 1.0_wp
  gamma0 = 1000.0_wp
  lamw = 0.04_wp
  ux = 1.0_wp
  uy = 1.0_wp
  und = ''


  call tScale%init(rho, aw, gamma0, lamw, und, ux, uy)

  tScale%qOneD = .false.  ! should probably not have qOneD in scaling type...


  sX = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sY = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sZ2 = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sPr = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sPi = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sGam = [0.9_wp, 1.0_wp, 2.1_wp, 1.0_wp, 1.2_wp]
  sA(:) = 1.0_wp
  sZ = 0.0_wp

  sX_ex = sX
  sY_ex = sY
  sZ2_ex = sZ2
  sPr_ex = [0.14166669791590880_wp, 7.0833348957954401e-2_wp, 0.0_wp, &
            -7.0833348957954401e-002_wp, -0.14166669791590880_wp]
  sPi_ex = [5.8333302084091224e-2_wp, 2.9166651042045612e-2_wp, &
            0.0_wp, -2.9166651042045612E-2_wp, -5.8333302084091224e-2_wp]
  sGam_ex = sGam
  sA_ex = sA
  sZ_ex = sZ

  tQuad = fQuad(0.0_wp, 2.4_wp, 2.4_wp)  ! Implicit constructor

  tol = 1e-9_wp


  call tQuad%prop(sX, sY, sZ2, sPr, sPi, sGam, sA, tfmesh, tScale, sZ)

  @AssertEqual( sX, sX_ex, tol )
  @AssertEqual( sY, sY_ex, tol )
  @AssertEqual( sZ2, sZ2_ex, tol )
  @AssertEqual( sPr, sPr_ex, tol )
  @AssertEqual( sPi, sPi_ex, tol )
  @AssertEqual( sGam, sGam_ex, tol )
  @AssertEqual( sA, sA_ex, tol )
  @AssertEqual( sZ, sZ_ex, tol )

end subroutine fullQTest







