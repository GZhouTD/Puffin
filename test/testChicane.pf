!                      Full test:

@test
subroutine fullChicTest( )

  use paratype
  use typeScale
  use typeChicane
  use typeFMesh
  use pfunit_mod

  implicit none

  real(kind=wp) :: gamma0, rho, aw, ux, uy, lamw
  character(32_ip) :: und

  type(fScale) :: tScale
  type(fChicane) :: tChicane
  type(fFmesh) :: tfmesh


  real(kind=wp) :: sX(5), sY(5), sZ2(5), sPr(5), sPi(5), sGam(5)

  real(kind=wp) :: sA(10)
  
  real(kind=wp) :: sX_ex(5), sY_ex(5), sZ2_ex(5), sPr_ex(5), sPi_ex(5), sGam_ex(5)

  real(kind=wp) :: sA_ex(10)
  real(kind=wp) :: sZ, sZ_ex

  real(kind=wp) :: tol

  rho = 0.001_wp
  aw = 1.0_wp
  gamma0 = 1000.0_wp
  lamw = 0.04_wp
  ux = 1.0_wp
  uy = 1.0_wp
  und = ''


  call tScale%init(rho, aw, gamma0, lamw, und, ux, uy)

  tScale%qOneD = .false.  ! should probably not have qOneD in scaling type...


  sX = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sY = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sZ2 = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sPr = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sPi = [0.1_wp, 0.05_wp, 0.0_wp, -0.05_wp, -0.1_wp]
  sGam = [0.9_wp, 1.0_wp, 2.1_wp, 1.0_wp, 1.2_wp]
  sA(:) = 1.0_wp
  sZ = 0.0_wp

  sX_ex = sX
  sY_ex = sY
  sZ2_ex = [0.42999999999999994_wp, 0.17999999999999999_wp, &
           -2.0700000000000003_wp, &
            8.0000000000000002E-2_wp, -0.36999999999999988_wp]
  sPr_ex = sPr
  sPi_ex = sPi
  sGam_ex = sGam
  sA_ex = sA
  sZ_ex = sZ

  tChicane = fChicane(0.0_wp, 0.13_wp, 1.0_wp)  ! Implicit constructor

  tol = 1e-9_wp


  call tChicane%prop(sX, sY, sZ2, sPr, sPi, sGam, sA, tfmesh, tScale, sZ)

  @AssertEqual( sX, sX_ex, tol )
  @AssertEqual( sY, sY_ex, tol )
  @AssertEqual( sZ2, sZ2_ex, tol )
  @AssertEqual( sPr, sPr_ex, tol )
  @AssertEqual( sPi, sPi_ex, tol )
  @AssertEqual( sGam, sGam_ex, tol )
  @AssertEqual( sA, sA_ex, tol )
  @AssertEqual( sZ, sZ_ex, tol )

end subroutine fullChicTest
